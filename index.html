<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zig Zag Game</title>
</head>

<body style="margin: 0px; overflow: hidden">

    <canvas id="myCanvas" style="background-color: black;"></canvas>

    <div id="scoreboard" style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); color: white; font-size: 24px; background-color: black; padding: 5px; border: 2px solid white; border-radius: 5px; user-select: none;">
        Score: <span id="score">0</span>
    </div>
    <script src="track.js"></script>
    <script src="rectangle.js"></script>
    <script src="player.js"></script>
    <script>
        myCanvas.width = window.innerWidth
        myCanvas.height = window.innerHeight

        const ctx = myCanvas.getContext("2d")

        const m = 100
        const l = 300
        const N = 10
        const playerSize = 15
        const speed = 5
        let x = 0
        let y = 0
        let count = 0
        let score = 0

        const rectangles = []

        const track = new Track(x, y, N, m, l)

        const player = new Player(m/2, m/2, playerSize, speed)

        myCanvas.addEventListener("pointerdown", () => player.changeDirection())

        animate()

        function animate() {

            count++
            if (count % 600 === 0) {
                track.l = 450
                track.m = 70
            }
            if (count % 1200 === 0) {
                track.l = 550
                track.m = 70
            }
            if (count % 1800 === 0) {
                track.l = 600
                track.m = 50
            }

            player.move()
            track.adjustFor(player)

            if (!track.contains(player)) return

            ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)

            ctx.save()
            ctx.translate(myCanvas.width / 2, myCanvas.height / 2)
            ctx.rotate(-3 * Math.PI / 4)
            ctx.translate(-player.x, -player.y)


            track.draw(ctx)
            player.draw(ctx)

            updateScore()

            ctx.restore()

            requestAnimationFrame(animate)
        }
        function updateScore() {
            score++
            document.getElementById("score").innerText = score
        }

    </script>

</body>

</html>